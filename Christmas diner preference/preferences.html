<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dinner Preference Database</title>
  <style>
    :root {
      color-scheme: light dark;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      margin: 0;
      padding: 2rem;
      min-height: 100vh;
      background:
        linear-gradient(rgba(7, 17, 35, 0.7), rgba(7, 17, 35, 0.8)),
        url("https://images.unsplash.com/photo-1519681393784-d120267933ba?auto=format&fit=crop&w=1600&q=80")
          center/cover fixed;
      color: #fdf5f2;
    }

    main {
      max-width: 960px;
      margin: 0 auto;
      background: rgba(255, 255, 255, 0.08);
      backdrop-filter: blur(18px);
      border-radius: 1.25rem;
      padding: 2.75rem;
      box-shadow: 0 1.5rem 3rem rgba(0, 0, 0, 0.35);
    }

    h1 {
      margin-top: 0;
      font-size: clamp(2rem, 4vw, 3rem);
    }

    .garland {
      width: min(240px, 40%);
      display: block;
      margin: 0 0 1.5rem auto;
      border-radius: 1rem;
      border: 3px solid rgba(255, 255, 255, 0.35);
      box-shadow: 0 1rem 2rem rgba(0, 0, 0, 0.4);
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 2rem;
      overflow: hidden;
      border-radius: 1rem;
      font-size: 0.95rem;
    }

    th,
    td {
      padding: 0.85rem 1rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.08);
      vertical-align: top;
    }

    th {
      text-align: left;
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #f3c98b;
      background: rgba(7, 17, 35, 0.7);
    }

    tbody tr:nth-child(odd) {
      background: rgba(255, 255, 255, 0.03);
    }

    .actions {
      margin-top: 1rem;
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
    }

    .button {
      border-radius: 2rem;
      padding: 0.75rem 1.5rem;
      font-weight: 600;
      border: none;
      cursor: pointer;
      transition: transform 120ms ease, box-shadow 120ms ease;
    }

    .button:hover {
      transform: translateY(-1px);
      box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
    }

    .button.primary {
      background: #d7263d;
      color: white;
    }

    .button.secondary {
      background: rgba(255, 255, 255, 0.12);
      color: #fdf5f2;
    }

    caption {
      caption-side: bottom;
      padding-top: 0.75rem;
      color: #d2d7ef;
      font-size: 0.9rem;
    }

    @media (max-width: 720px) {
      table {
        display: block;
        overflow-x: auto;
        white-space: nowrap;
      }
    }
  </style>
</head>
<body>
  <main>
    <h1>Shared Dinner Preference Database</h1>
    <img class="garland" src="https://images.unsplash.com/photo-1481833761820-0509d3217039?auto=format&fit=crop&w=500&q=80" alt="Christmas ornaments" loading="lazy">
    <p>Review each guest’s starter, main, and dessert preferences—everything stays in your browser so you can plan with confidence.</p>

    <div class="actions">
      <a class="button secondary" href="index.html">← Add another preference</a>
      <button class="button primary" id="clearButton">Clear database</button>
    </div>

    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Starter</th>
          <th>Main</th>
          <th>Dessert</th>
          <th>Dietary Notes</th>
          <th>Submitted</th>
        </tr>
      </thead>
      <tbody id="tableBody">
        <tr>
          <td colspan="6">Loading dinner data…</td>
        </tr>
      </tbody>
      <caption>Stored locally under <code>christmas-dinner-preferences</code>. Data never leaves this browser.</caption>
    </table>
  </main>

  <script>
    const STORAGE_KEY = "christmas-dinner-preferences";
    const tableBody = document.getElementById("tableBody");
    const clearButton = document.getElementById("clearButton");

    function loadPreferences() {
      try {
        const raw = localStorage.getItem(STORAGE_KEY);
        const data = raw ? JSON.parse(raw) : [];
        renderRows(data);
      } catch {
        renderRows([]);
      }
    }

    function renderRows(rows) {
      tableBody.innerHTML = "";
      if (!rows.length) {
        const row = document.createElement("tr");
        row.innerHTML = `<td colspan="6">No dinner preferences saved yet.</td>`;
        tableBody.appendChild(row);
        return;
      }

      rows
        .slice()
        .sort((a, b) => b.createdAt - a.createdAt)
        .forEach((item) => {
          const submitted = new Date(item.createdAt).toLocaleString();
          const starter =
            item.starter ||
            (item.course === "Starter" ? item.dish : "") ||
            "—";
          const main =
            item.main ||
            (item.course === "Main" ? item.dish : "") ||
            "—";
          const dessert =
            item.dessert ||
            (item.course === "Dessert" ? item.dish : "") ||
            "—";

          const row = document.createElement("tr");
          row.innerHTML = `
            <td>${item.name}</td>
            <td>${starter}</td>
            <td>${main}</td>
            <td>${dessert}</td>
            <td>${item.notes || "—"}</td>
            <td>${submitted}</td>
          `;
          tableBody.appendChild(row);
        });
    }

    clearButton.addEventListener("click", () => {
      if (!confirm("Remove all saved dinner preferences?")) {
        return;
      }
      localStorage.removeItem(STORAGE_KEY);
      renderRows([]);
    });

    loadPreferences();
  </script>
</body>
</html>
